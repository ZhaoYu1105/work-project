<div class="ks-orderDetail">
    <div layout="row" style="margin:0 20px;">
        <div class="ks-itemOrderList-time-Box" flex="30">
            <div class="ks-itemOrderList-timeBox-top">
                <b>配送相关</b>
            </div>
            <div class="ks-itemOrderList-timeBox-row">
                <div layout="row" style="width: 100%;height: 100%;">
                    <div flex="20" class="box-label"><b>订单号:</b></div>
                    <div flex="80" class="box-value" layout="column" layout-align="center start">
                        <span style="line-height: 1em">
                            {{order.seq}}
                        </span>
                    </div>
                </div>
            </div>
            <div class="ks-itemOrderList-timeBox-row" >
                <div layout="row" style="width: 100%;height: 100%;">
                    <div flex="20" class="box-label" style="line-height: 30px;"><b>收货信息:</b></div>
                    <div flex="80" layout="column">
                        <div class="box-value" layout="column" layout-align="center start">
                            <span style="line-height: 30px">{{order.address.receiver}}&nbsp;&nbsp;{{order.address.phone}}</span>
                        </div>
                        <div class="box-value" layout="column" layout-align="center start">
                            <span style="line-height: 30px;word-break: break-all;">{{order.address.province}}{{order.address.city}}{{order.address.county}}{{order.address.street}}</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="ks-itemOrderList-timeBox-row">
                <div layout="row">
                    <div flex="20" class="box-label"><b>下单用户:</b></div>
                    <div flex="80" class="box-value" layout="column" layout-align="center start">
                        <span style="line-height: 1em">{{order.realName}}&nbsp;&nbsp;{{order.phone}}</span></div>
                </div>
            </div>
            <!--<div class="ks-itemOrderList-timeBox-row">-->
                <!--<div layout="row">-->
                    <!--<div flex="20" class="box-label"><b>联系人:</b></div>-->
                    <!--<div flex="80" class="box-value" layout="column" layout-align="center start">-->
                        <!--<span style="line-height: 1em">{{order.address.receiver}}</span></div>-->
                <!--</div>-->
            <!--</div>-->
            <div class="ks-itemOrderList-timeBox-row">
                <div layout="row">
                    <div flex="20" class="box-label"><b>渠道类型:</b></div>
                    <div flex="80" class="box-value" layout="column" layout-align="center start">
                        <span style="line-height: 1em">{{order.partnerType}}</span></div>
                </div>
            </div>
            <div class="ks-itemOrderList-timeBox-row">
                <div layout="row">
                    <div flex="20" class="box-label"><b>收货人:</b></div>
                    <div flex="80" class="box-value" layout="column" layout-align="center start">
                        <span style="line-height: 1em">{{order.address.receiver}}&nbsp;&nbsp;{{order.address.phone}}</span></div>
                </div>
            </div>
            <div class="ks-itemOrderList-timeBox-row">
                <div layout="row">
                    <div flex="20" class="box-label" ><b>创建时间:</b></div>
                    <div flex="80" class="box-value" layout="column" layout-align="center start">
                        <span style="line-height: 1em">{{order.dateCreated | date:"yyyy-MM-dd HH:mm:ss"}}</span>
                    </div>
                </div>
            </div>
            <div class="ks-itemOrderList-timeBox-row" style="border-bottom: none;">
                <div layout="row" style="width: 100%;height: 100%;">
                    <div flex="20" class="box-label"><b>买家备注:</b></div>
                    <div flex="80">
                        <div  class="box-value" layout="column" layout-align="center start">
                            <span  style="line-height: 30px;margin-top: 8px;word-break: break-all;">{{order.buyerMemo}}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--卖家备注-->
        <div class="ks-itemOrderList-status" flex="70">
            <div style="padding: 40px 0 0 38px;height: 255px;" layout="row">
                <div class="ks-itemOrderList-status-top">
                    <md-icon class="wrapIcon ts" md-font-set="ks-admin-font" md-font-icon="ks-tishi"></md-icon>
                </div>
                <div class="ks-itemOrderList-status-mid">
                    <div style="font-size: 18px;">
                        <span><b>订单状态：{{order.statusDesp}}</b></span>
                    </div>
                    <!--当状态为待支付-->
                    <div layout="column"  style="margin-top: 20px" ng-if="order.status==='UNPAYED'" >
                        <div layout="row">
                            <div style="text-align: right;margin-top: 20px;margin-right: 30px">
                                <input type="text" class="form-control input-sm"
                                       ng-model="order.adjust" style="width:200px;">
                            </div> <!--ng-if="ORDER_C"-->
                            <div flex style="margin-top: 18px" layout="row">
                                <button type="button" class="blue" ng-click="adjustAprice()" ng-if="ORDER_C">改价</button>
                                <button type="button" class=" noborder" ng-click="fallbackPage()" style="outline: none;">返回</button>
                            </div>
                        </div>
                        <div layout="row" style="margin-top: 20px;">

                            <!--当状态为待支付 可取消订单-->
                            <!--因退货退款问题暂时取消-->
                            <!--<button type="button" class="btn default" style="margin-left: 30px;outline: none;-->
                            <!--background: #fff;border: 1px solid #e0e0e0;" ng-click="cancelOrder()">取消订单</button>-->
                        </div>
                    </div>
                    <!--已取消-->
                    <div layout="column"  style="margin-top: 20px" ng-if="order.status==='CANCELED'">
                        <div layout="row" style="margin-top: 20px;">
                            <button type="button" class=" noborder" ng-click="fallbackPage()" style="outline: none;">返回</button>
                        </div>
                    </div>
                    <!--已关闭-->
                    <div layout="column"  style="margin-top: 20px" ng-if="order.status==='CLOSED'">
                        <div layout="row" style="margin-top: 40px;">
                            <button type="button" class=" noborder" ng-click="fallbackPage()" style="outline: none;">返回</button>
                        </div>
                    </div>
                    <!--已拒绝-->
                    <div layout="column"  style="margin-top: 20px" ng-if="order.status==='REJECTED'">
                        <div layout="row" style="margin-top: 20px;">
                            <label style="font-weight: 500;">拒绝备注：</label>
                            <span>{{order.memo}}</span>
                        </div>
                        <div layout="row" style="margin: 20px 0 0 68px;">
                            <button type="button" class=" noborder" ng-click="fallbackPage()" style="outline: none;">返回</button>
                        </div>
                    </div>
                    <!--已完成-->
                    <div layout="column"  style="margin-top: 20px" ng-if="order.status==='FINISHED'">
                        <div layout="row" flex style="font-size: 18px;line-height: 30px;">
                            <div><b>物流公司:</b></div>
                            <div>{{order.logisticses[0].company}}</div>
                        </div>
                        <div layout="row" flex style="font-size: 18px;line-height: 30px;">
                            <div ><b>物流单号:</b></div>
                            <div>{{order.logisticses[0].expressNo}}</div>
                        </div>
                        <div layout="row" style="margin-left: -20px;">
                            <button type="button" class="noborder" ng-click="fallbackPage()" style="outline: none;">返回</button>
                        </div>
                    </div>
                    <!--待确认-->
                    <div layout="column"   style="margin-top: 20px" class="kf-serve" ng-if="order.status==='UNCONFIRMED'">
                        <div layout="row" flex style="font-size: medium" class="serve">
                            <button class="blue" ng-click="confirmOrder();">确认接单</button>
                            <button class="border" ng-click="updateAddress({address: order.address,orderId: order.id},$event)">修改地址</button>
                            <button class="noborder" ng-click="remark($event)">卖家备注</button>
                            <!--因退货退款问题暂时取消-->
                            <button class="noborder" ng-click="defaultOrd($event)">拒绝接单</button>
                            <button class="noborder" ng-click="fallbackPage()">返回</button>
                        </div>
                        <div layout="row" flex style="font-size: medium">

                            <!--<button ng-click="cancelOrder()">取消接单</button>-->
                        </div>
                    </div>
                    <!--待发货-->
                    <div class="ks-itemOrderList-status-bottom" ng-if="order.status == 'UNSHIPPED'">

                        <button type="button" class=" blue"
                                 ng-if="DELIVERINVOICE_R"  ui-sref="main.brandApp.sendDetail({id:sendId})">查看发货单
                        </button>
                        <button type="button" class="btn border"
                                style="background-color:#fff;border: 1px solid #e0e0e0;margin-right: 10px"
                                ng-click="updateAddress({address: order.address,orderId: order.id},$event)"
                                ng-if="DELIVERINVOICE_C">
                            修改收货地址
                        </button>
                        <!--<button ng-click="cancelOrder()" class="btn noborder">取消接单</button>-->
                        <button ng-click="remark($event)" class="btn noborder">卖家备注</button>
                        <button type="button" class="btn noborder" ng-click="fallbackPage()" style="outline: none;">返回</button>
                    </div>
                    <!--待收货-->
                    <div layout="column" class="ks-itemOrderList-status-bottom"  style="margin-top: 20px" ng-if="order.status=='UNRECEIVED'">
                        <div layout="row" flex style="height: 30px;">
                            <b style="height:30px;line-height:30px;font-weight:500;">物流公司:</b>
                            <span style="height:30px;line-height:30px;">{{order.logisticses[0].company}}</span>
                        </div>
                        <div layout="row" flex style="height: 30px;">
                            <b style="height:30px;line-height:30px;font-weight:500;">物流单号:</b>
                            <span style="height:30px;line-height:30px;">{{order.logisticses[0].expressNo}}</span>
                        </div>
                        <div layout="row" style="margin-left: -20px;">
                            <button type="button" class="btn noborder" ng-click="fallbackPage()" style="outline: none;">返回</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="ks-item-memo" style="border-top: 1px solid #e0e0e0;" layout="row">
                <label>卖家备注：</label>
                <ul layout="column">
                    <li ng-bind-html="memo"></li>
                </ul>
            </div>
        </div>
    </div>
    <!--订单表头-->
    <div class="tableTit" layout="row">
        <div class="tableTd" flex="40" style="text-align: left;padding-left: 10px;">
            <span>商品</span>
        </div>
        <div class="tableTd" flex="15">
            <span>单价</span>
        </div>
        <div class="tableTd" flex="15">
            <span>商品编码</span>
        </div>
        <div class="tableTd" flex="15">
            <span>数量</span>
        </div>
        <div class="tableTd" flex="15">
            <span>小计</span>
        </div>
    </div>
    <!--订单-->
    <div class="tableCon">
        <!--一个订单编号-->
        <div class="orderNumber">
            <!--订单头部-->
            <!--<div class="ordTitle" layout="row">-->
                <!--<div flex="15" class="tit" style="min-width: 220px;">-->
                    <!--<span>订单号：{{order.seq}}</span>-->
                <!--</div>-->
                <!--<div flex="15" class="tit" style="min-width: 220px;">-->
                    <!--<span>成交时间：{{order.dateCreated | date:"yyyy-MM-dd HH:mm:ss"}}</span>-->
                <!--</div>-->
            <!--</div>-->
            <!--订单信息-->
            <div class="ordDetail" layout="row">
                <div flex="100" class="orderXq" layout="column">
                    <!--当订单为一个或多个-->
                    <div layout="row" class="xqNum" ng-repeat="item in items">
                        <div flex="40" layout="row" >
                            <div class="pic">
                                <img ng-src="{{item.skuImg}}">
                            </div>
                            <div layout="column" class="goodsDetail">
                                <span style="text-align: left;">{{item.itemTitle}}</span>
                                <span style="text-align: left;" ng-repeat="sk in item.specInfos">{{sk.propValue}}</span>
                            </div>
                        </div>
                        <div flex="15"><span>￥{{item.skuPrice/100 | num:2}}</span></div>
                        <div flex="15"><span>{{item.code}}</span></div>
                        <div flex="15"><span>x{{item.num}}</span></div>
                        <div flex="15"><span>￥{{(item.skuPrice/100)*item.num | num:2}}</span></div>
                    </div>
                </div>
            </div>
        </div>
        <!--优惠信息-->
        <div class="orderDiscount">
            <ul>
                <li layout="row" layout-align="end">
                    <span class="discount-left">共{{order.total}}件商品,总计：</span>
                    <span class="discount-right">{{order.adjustPrice/100 +(order.balancePrice/100) +(order.noCashBalancePrice/100 )+(order.paymentPrice/100) | num:2}}元</span>
                </li>
                <li layout="row" layout-align="end"><span class="discount-left">改价优惠：</span><span class="discount-right">{{order.adjustPrice/100 | num:2}}元</span></li>
                <li layout="row" layout-align="end"><span class="discount-left">货款余额抵扣：</span><span class="discount-right">{{order.noCashBalancePrice/100 | num:2}}元</span></li>
                <li layout="row" layout-align="end"><span class="discount-left">账户余额抵扣：</span><span class="discount-right">{{order.balancePrice/100 | num:2}}元</span></li>
                <li layout="row" layout-align="end"><span class="discount-left">实付：</span><span class="discount-right">{{order.paymentPrice/100 | num:2}}元</span></li>
            </ul>
        </div>
    </div>
</div>

<!--//发货tk-->
<script type="text/ng-template" id="sendDialog.html">
    <div class="md-dialog-container" >
        <md-dialog aria-label="发货确认" class="refundTk">
            <!--发货填写物流公司以及单号    弹出框-->
            <div layout="column" class="tck" style="position:absolute;">
                <h2>填写物流信息</h2>
                <div layout="row">
                    <label>物流公司：</label>
                    <select>
                        <option value="">请选择</option>
                    </select>
                </div>
                <div layout="row">
                    <label>物流单号：</label>
                    <input type="text">
                </div>
                <div layout="row">
                    <button>确定</button>
                    <button ng-click="vmd.cancel()">取消</button>
                </div>
            </div>
        </md-dialog>
    </div>
</script>
<!--//拒绝接单tk-->
<script type="text/ng-template" id="defaultOrder.html">
    <div class="md-dialog-container" >
        <md-dialog aria-label="退款确认" class="refundTk">
            <!--发货填写物流公司以及单号    弹出框-->
            <div layout="column" class="tck" style="position:absolute;">
                <h2>拒绝接单确认</h2>
                <div layout="row" class="defaultTck">
                    <label style="margin: 0 5px 0 25px;padding:0px;">原因：</label>
                    <textarea ng-model="vmd.reason"></textarea>
                </div>
                <div layout="row">
                    <button ng-click="vmd.reject();" style="margin:20px 30px 0 84px;color: #fff;background: #ba9f6e;">确定</button>
                    <button ng-click="vmd.cancel()" style="margin: 20px 0 0 0 ;">取消</button>
                </div>
            </div>
        </md-dialog>
    </div>
</script>
<!--////卖家备注tk-->
<script type="text/ng-template" id="remark.html">
    <div class="md-dialog-container" >
        <md-dialog aria-label="卖家备注" class="refundTk">
            <!--发货填写物流公司以及单号    弹出框-->
            <div layout="column" class="tck" style="position:absolute;">
                <h2>卖家备注</h2>
                <div layout="row" class="defaultTck">
                    <label style="margin: 0 5px 0 25px;padding:0px;">内容：</label>
                    <textarea ng-model="vmd.memo"></textarea>
                </div>
                <div layout="row">
                    <button ng-click="vmd.sellerMemo();" style="margin:20px 30px 0 84px;color: #fff;background: #ba9f6e;">确定</button>
                    <button ng-click="vmd.cancel()" style="margin: 20px 0 0 0 ;">取消</button>
                </div>
            </div>
        </md-dialog>
    </div>
</script>